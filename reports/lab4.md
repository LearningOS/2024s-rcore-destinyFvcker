# 实验四报告-chapter6 练习

- [实验四报告-chapter6 练习](#实验四报告-chapter6-练习)
  - [实现总结](#实现总结)
  - [简答作业](#简答作业)
  - [荣誉准则](#荣誉准则)

## 实现总结

主要就是把 Stat 移动到了 easy-fs 之中，然后在 File 接口之中多要求了一个方法 stat，并在 OSInode 之中实现它，并在 easy-fs 下的 vfs.rs 之中实现了对应系统调用需要的相应逻辑：

- stat
  实际上就是去 DiskInode 之中把连接数给读出来，然后其他的信息都可以在 Inode 数据结构之中找到
- link
  首先在操作系统内核进行系统调用处理的时候判断一下是不是两个连接的名字相同，如果不相同就调用对应 ROOT_DIR 的 link 方法进行处理，link 方法实际上就是 inode 的方法，它会将对应索引节点查出来，并添加一个目录项到里面
- unlink
  也是调用 ROOT_DIR 的 unlink 方法进行处理，unlink 方法首先查询是不是有这个目录项，如果查询到了这个目录项，就先清空原有的所有目录项，因为现在没有足够的信息找到对应的目录项进行删除，没有对应的位图记录是否对应的目录项空闲并可以使用，然后将除了这个目标目录项的其他目录项都恢复，最后利用找到的目录项的 inode 号，判断是否已经没有指向它的硬链接，如果没有了的话，就把这个文件删除，如果还有的话，就仅仅是对硬链接数减一

## 简答作业

1. root inode 起着什么作用？如果 root inode 中的内容损坏了，会发生什么？（来自 ch6）
   root inode 管理着所有文件的连接情况，并且用户只能通过 root inode 索引节点之中记录的目录项来找到对应的应用程序执行，如果损坏了，用户将不能正确找到目标可执行文件进行执行

2. 举出使用 pipe 的一个实际应用的例子。（来自 ch7）
   实际应用示例：用 grep 和 sort 查找和排序日志文件中的错误信息
   假设我们有一个名为 app.log 的日志文件，其中包含了大量的日志信息。我们希望查找包含关键字 "ERROR" 的行，并将这些行按照字母顺序排序。我们可以通过管道将 grep 的输出直接传递给 sort 来实现这一点。

3. 如果需要在多个进程间互相通信，则需要为每一对进程建立一个管道，非常繁琐，请设计一个更易用的多进程通信机制。
   共享内存机制，只需要在操作系统之中申请并登记一块物理内存，然后将这块内存映射到需要共享的进程的页表之中，然后每一个进程通过加锁的方式对这块共享内存进行互斥访问就可以非常方便地实现多进程通信，不需要两两设置管道。

## 荣誉准则

1. 在完成本次实验的过程（含此前学习的过程）中，我曾分别与 以下各位 就（与本次实验相关的）以下方面做过交流，还在代码中对应的位置以注释形式记录了具体的交流对象及内容：

   - 我并没有和任何人进行交流，单独完成了此次任务

2. 此外，我也参考了 以下资料 ，还在代码中对应的位置以注释形式记录了具体的参考来源及内容：

   - rCore-Tutorial-Book-v3 3.6.0- alpha.1 文档
   - rCore-Tutorial-Guide-2024S 文档

3. 我独立完成了本次实验除以上方面之外的所有工作，包括代码与文档。 我清楚地知道，从以上方面获得的信息在一定程度上降低了实验难度，可能会影响起评分。

4. 我从未使用过他人的代码，不管是原封不动地复制，还是经过了某些等价转换。 我未曾也不会向他人（含此后各届同学）复制或公开我的实验代码，我有义务妥善保管好它们。 我提交至本实验的评测系统的代码，均无意于破坏或妨碍任何计算机系统的正常运转。 我清楚地知道，以上情况均为本课程纪律所禁止，若违反，对应的实验成绩将按“-100”分计。
